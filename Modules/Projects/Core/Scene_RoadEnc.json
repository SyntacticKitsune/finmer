{
	"!Type": "AssetScene",
	"AssetID": "0a1575cb-f99e-4ca1-9558-dffbdfcb1c28",
	"AssetName": "Scene_RoadEnc",
	"ScriptEnter": {
		"!Type": "ScriptDataExternal",
		"Name": "Scene_RoadEnc_Enter"
	},
	"IsPatch": false,
	"Root": {
		"NodeType": "Root",
		"Key": "Root",
		"Children": [
			{
				"NodeType": "State",
				"Key": "ENC_MQ02Ambush",
				"ScriptAction": {
					"!Type": "ScriptDataInline",
					"Script": "SaveData.TakeCheckpoint()\r\nStorage.SetFlag(\"mq02_road_antag_scheduled\", false)\r\nStorage.SetFlag(\"mq02_ambushed\", true)\r\nLog(\"MQ02_AM_OPENING1\")\r\nPreySense(Creature(\"CR_MQ02_Randall\"), EPreySenseType.OralVore, EPreySenseType.DigestionFatal)"
				},
				"ScriptAppear": {
					"!Type": "ScriptDataInline",
					"Script": "return Storage.GetFlag(\"mq02_road_antag_scheduled\")"
				},
				"Children": [
					{
						"NodeType": "Choice",
						"Key": "MQ02A_C_Opening2",
						"Title": "Continue",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"Children": [
							{
								"NodeType": "State",
								"Key": "MQ02A_R_Opening2",
								"ScriptAction": {
									"!Type": "ScriptDataInline",
									"Script": "Log(\"MQ02_AM_OPENING2\")"
								},
								"Children": [
									{
										"NodeType": "Choice",
										"Key": "MQ02A_C_Opening3",
										"Title": "Continue",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"Children": [
											{
												"NodeType": "State",
												"Key": "MQ02A_R_Opening3",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"MQ02_AM_OPENING3\")"
												},
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_HelloNice",
														"Title": "Honest",
														"Tooltip": "Tell him who you are.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_HelloNice",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ02_AM_HELLO_NICE\")\r\nStorage.ModifyNumber(\"rep_randall\", -1)"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_Business",
																		"Title": "Continue",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_Business1",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_BUSINESS1\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02A_C_Business1B",
																						"Title": "Continue",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02A_R_Business2",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"MQ02_AM_BUSINESS2\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ02A_C_Business3",
																										"Title": "Continue",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_Business3B",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"MQ02_AM_BUSINESS3B\")\r\nStorage.ModifyNumber(\"rep_randall\", 1)"
																												},
																												"ScriptAppear": {
																													"!Type": "ScriptDataInline",
																													"Script": "return Storage.GetFlag(\"oliver_eaten\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Link",
																														"LinkTarget": "MQ02A_C_Ending"
																													}
																												]
																											},
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_Business3",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"MQ02_AM_BUSINESS3\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Choice",
																														"Key": "MQ02A_C_Ending",
																														"Title": "Continue",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"Children": [
																															{
																																"NodeType": "State",
																																"Key": "MQ02A_R_Ending",
																																"ScriptAction": {
																																	"!Type": "ScriptDataInline",
																																	"Script": "Log(\"MQ02_AM_ENDING\")"
																																},
																																"Children": [
																																	{
																																		"NodeType": "Choice",
																																		"Key": "MQ02A_C_Finish",
																																		"Title": "Continue",
																																		"Highlight": false,
																																		"ButtonWidth": 1.0,
																																		"Children": [
																																			{
																																				"NodeType": "State",
																																				"Key": "MQ02A_R_Finish",
																																				"ScriptAction": {
																																					"!Type": "ScriptDataInline",
																																					"Script": "Log(\"MQ02_AM_FINISH\")\r\nJournal.Update(\"MQ02\", Storage.GetFlag(\"oliver_dead\") and 21 or 20)\r\n\r\nif not Storage.GetFlag(\"MQ02_RANDALL_FOUGHT\") then\r\n    Player:AwardXP(RewardXP.MQ02_EncNoViolence)\r\nend"
																																				},
																																				"Children": [
																																					{
																																						"NodeType": "Link",
																																						"LinkTarget": "GoNextEncounter"
																																					}
																																				]
																																			}
																																		]
																																	}
																																]
																															}
																														]
																													}
																												]
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_HelloNotNice",
														"Title": "Reserved",
														"Tooltip": "Who's asking?",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_HelloNotNice",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ02_AM_HELLO_NOT_NICE\")"
																},
																"Children": [
																	{
																		"NodeType": "Link",
																		"LinkTarget": "MQ02A_C_Business"
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_HelloAccuse",
														"Title": "Accusatory",
														"Tooltip": "This guy is who Oliver warned you about. Ask him about his prey.",
														"Highlight": true,
														"ButtonWidth": 1.0,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "-- did Oliver warn the player about Randall?\r\nreturn Storage.GetFlag(\"MQ02_OLIVER_R_SPILL_WOLF\")"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_HelloAccuse",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ02_AM_HELLO_REALLY_NOT_NICE\")\r\nStorage.ModifyNumber(\"rep_randall\", 1)"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_HelloPush",
																		"Title": "Push",
																		"Tooltip": "Give him a good shove. Back off, punk.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_HelloPush",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_HELLO_SHOVE\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02A_C_Business"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_HelloLick",
																		"Title": "Lick",
																		"Tooltip": "Lick his muzzle. Probably not what he expects.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_HelloLick",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_HELLO_LICK\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02A_C_Business"
																					},
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02A_C_Bellyrub",
																						"Title": "Bellyrub",
																						"Tooltip": "Tease him further with a rub on that fuzzy gut.",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02A_R_Bellyrub",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"MQ02_AM_BELLYRUB\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ02A_C_WillingVore",
																										"Title": "Submit",
																										"Tooltip": "Let the wolf swallow you, like the tasty preything you are.",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"ScriptAction": {
																											"!Type": "ScriptDataInline",
																											"Script": "-- Player gets gulped by Randall\r\nLog(\"MQ02_RANDALL_VORE_WIN_POV\")\r\nlocal fight = Combat2()\r\nlocal randall = Creature(\"CR_MQ02_Randall\")\r\nfight:AddParticipant(Player)\r\nfight:AddParticipant(randall)\r\nfight:SetVored(randall, Player)\r\nfight:Begin()"
																										},
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_Dummy1",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "-- you're not supposed to be able to win the willing vore fight\r\nerror()"
																												},
																												"Children": []
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_HelloPunch",
																		"Title": "Punch",
																		"Tooltip": "Your knuckles are itching. Use them.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_HelloPunch",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_HELLO_PUNCH\")\r\nStorage.ModifyNumber(\"rep_randall\", -1)"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02A_C_Business"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_Stab",
																		"Title": "Stab",
																		"Tooltip": "He's close, and your dagger is small enough to quickly pull out!",
																		"Highlight": true,
																		"ButtonWidth": 1.0,
																		"ScriptAppear": {
																			"!Type": "ScriptDataVisualCondition",
																			"Mode": "All",
																			"Operand": true,
																			"Tests": [
																				{
																					"!Type": "ConditionPlayerEquipment",
																					"ItemGuid": "795c79f2-ce54-4c2f-837e-d767e3c2599a"
																				}
																			]
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_Stab",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Text.SetVariable(\"weapon\", Player.EquippedWeapon.Alias)\r\nLog(\"MQ02_AM_HELLO_STAB\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02A_C_Fight",
																						"Title": "Let's roll",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02A_R_Fight",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "local fight = Combat2()\r\nlocal randall = Creature(\"CR_MQ02_Randall\")\r\nlocal goon1 = Creature(\"CR_MQ02_Goon1\")\r\nlocal goon2 = Creature(\"CR_MQ02_Goon2\")\r\n\r\n-- Reflect the stab in the upcoming fight - mostly visual\r\nrandall.Health = randall.Health - 1\r\n\r\nfight:AddParticipant(Player)\r\nfight:AddParticipant(randall)\r\nfight:AddParticipant(goon1)\r\nfight:AddParticipant(goon2)\r\nfight:OnCreatureVored(function(pred, prey)\r\n    -- Goons flee when Randall is swallowed\r\n    if prey == randall then\r\n        local goon1_ok = not goon1:IsDead() and not fight:IsSwallowed(goon1)\r\n        local goon2_ok = not goon2:IsDead() and not fight:IsSwallowed(goon2)\r\n        if goon1_ok and goon2_ok then\r\n            -- Both alive\r\n            Log(\"MQ02_AM_WINFIGHT_GOON_FLEE2\")\r\n        elseif goon1_ok ~= goon2_ok then\r\n            -- One alive\r\n            Text.SetContext(\"goon\", goon1_ok and goon1 or goon2)\r\n            Log(\"MQ02_AM_WINFIGHT_GOON_FLEE1\")\r\n        end\r\n\r\n        Log(\"MQ02_RANDALL_KILL_DIGESTED\")\r\n        Sleep(3)\r\n\r\n        fight:End()\r\n    end\r\nend)\r\nfight:Begin()\r\n\r\n-- Wrap-up\r\nif fight:IsSwallowed(randall) then\r\n    Log(\"MQ02_AM_WINFIGHT_VORE\")\r\nelse\r\n    Log(\"MQ02_AM_WINFIGHT\")\r\nend"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ02A_C_CrabRangoon1",
																										"Title": "Continue",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_CrabRangoon1",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"MQ02_AM_WINFIGHT_CRAB_RANGOON1\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Choice",
																														"Key": "MQ02A_C_CrabRangoon2",
																														"Title": "Continue",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"Children": [
																															{
																																"NodeType": "State",
																																"Key": "MQ02A_R_CrabRangoon2",
																																"ScriptAction": {
																																	"!Type": "ScriptDataInline",
																																	"Script": "Log(\"MQ02_AM_WINFIGHT_CRAB_RANGOON2\")\r\nEndGame()"
																																},
																																"Children": []
																															}
																														]
																													}
																												]
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													}
												]
											}
										]
									}
								]
							}
						]
					}
				]
			},
			{
				"NodeType": "State",
				"Key": "ENC_None",
				"ScriptAction": {
					"!Type": "ScriptDataInline",
					"Script": "Log(\"ROAD_NO_ENC\")"
				},
				"Children": [
					{
						"NodeType": "Choice",
						"Key": "GoNextEncounter",
						"Title": "Move on",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": {
							"!Type": "ScriptDataInline",
							"Script": "ContinueRoadTravel()"
						},
						"Children": []
					}
				]
			}
		]
	}
}