{
	"!Type": "AssetScene",
	"AssetID": "0a1575cb-f99e-4ca1-9558-dffbdfcb1c28",
	"AssetName": "Scene_RoadEnc",
	"ScriptEnter": {
		"!Type": "ScriptDataExternal",
		"Name": "Scene_RoadEnc_Enter"
	},
	"IsPatch": false,
	"Root": {
		"NodeType": "Root",
		"Key": "Root",
		"Children": [
			{
				"NodeType": "State",
				"Key": "ENC_MQ02Ambush",
				"ScriptAction": {
					"!Type": "ScriptDataInline",
					"Script": "SaveData.TakeCheckpoint()\r\nStorage.SetFlag(\"mq02_road_antag_scheduled\", false)\r\nStorage.SetFlag(\"mq02_ambushed\", true)\r\nrandall = Creature(\"CR_MQ02_Randall\")\r\ngoon1 = Creature(\"CR_MQ02_Goon1\")\r\ngoon2 = Creature(\"CR_MQ02_Goon2\")\r\nLog(\"MQ02_AM_OPENING1\")\r\nPreySense(randall, EPreySenseType.OralVore, EPreySenseType.DigestionFatal)"
				},
				"ScriptAppear": {
					"!Type": "ScriptDataInline",
					"Script": "return Storage.GetFlag(\"mq02_road_antag_scheduled\")"
				},
				"Children": [
					{
						"NodeType": "Choice",
						"Key": "MQ02A_C_Opening2",
						"Title": "Continue",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"Children": [
							{
								"NodeType": "State",
								"Key": "MQ02A_R_Opening2",
								"ScriptAction": {
									"!Type": "ScriptDataInline",
									"Script": "Log(\"MQ02_AM_OPENING2\")"
								},
								"Children": [
									{
										"NodeType": "Choice",
										"Key": "MQ02A_C_Opening3",
										"Title": "Continue",
										"Highlight": false,
										"ButtonWidth": 1.0,
										"Children": [
											{
												"NodeType": "State",
												"Key": "MQ02A_R_Opening3",
												"ScriptAction": {
													"!Type": "ScriptDataInline",
													"Script": "Log(\"MQ02_AM_OPENING3\")"
												},
												"Children": [
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_HelloNice",
														"Title": "Honest",
														"Tooltip": "Tell him who you are.",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_HelloNice",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ02_AM_HELLO_NICE\")\r\nStorage.ModifyNumber(\"rep_randall\", -1)"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_Business",
																		"Title": "Continue",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_Business1",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_BUSINESS1\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02A_C_Business1B",
																						"Title": "Continue",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02A_R_Business2",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"MQ02_AM_BUSINESS2\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ02A_C_Business3",
																										"Title": "Continue",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_Business3B",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"MQ02_AM_BUSINESS3B\")\r\nStorage.ModifyNumber(\"rep_randall\", 1)"
																												},
																												"ScriptAppear": {
																													"!Type": "ScriptDataInline",
																													"Script": "return Storage.GetFlag(\"oliver_eaten\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Link",
																														"LinkTarget": "MQ02A_C_Ending"
																													}
																												]
																											},
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_Business3",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "Log(\"MQ02_AM_BUSINESS3\")"
																												},
																												"Children": [
																													{
																														"NodeType": "Choice",
																														"Key": "MQ02A_C_Ending",
																														"Title": "Continue",
																														"Highlight": false,
																														"ButtonWidth": 1.0,
																														"Children": [
																															{
																																"NodeType": "State",
																																"Key": "MQ02A_R_Ending",
																																"ScriptAction": {
																																	"!Type": "ScriptDataInline",
																																	"Script": "Log(\"MQ02_AM_ENDING\")"
																																},
																																"Children": [
																																	{
																																		"NodeType": "Choice",
																																		"Key": "MQ02A_C_Finish",
																																		"Title": "Continue",
																																		"Highlight": false,
																																		"ButtonWidth": 1.0,
																																		"Children": [
																																			{
																																				"NodeType": "State",
																																				"Key": "MQ02A_R_Finish",
																																				"ScriptAction": {
																																					"!Type": "ScriptDataInline",
																																					"Script": "Log(\"MQ02_AM_FINISH\")\r\nJournal.Update(\"MQ02\", Storage.GetFlag(\"oliver_dead\") and 21 or 20)\r\n\r\nif not Storage.GetFlag(\"MQ02_RANDALL_FOUGHT\") then\r\n    Player:AwardXP(RewardXP.MQ02_EncNoViolence)\r\nend"
																																				},
																																				"Children": [
																																					{
																																						"NodeType": "Link",
																																						"LinkTarget": "GoNextEncounter"
																																					}
																																				]
																																			}
																																		]
																																	}
																																]
																															}
																														]
																													}
																												]
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_HelloNotNice",
														"Title": "Reserved",
														"Tooltip": "Who's asking?",
														"Highlight": false,
														"ButtonWidth": 1.0,
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_HelloNotNice",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ02_AM_HELLO_NOT_NICE\")"
																},
																"Children": [
																	{
																		"NodeType": "Link",
																		"LinkTarget": "MQ02A_C_Business"
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_HelloAccuse",
														"Title": "Accusatory",
														"Tooltip": "This guy is who Oliver warned you about. Ask him about his prey.",
														"Highlight": true,
														"ButtonWidth": 1.0,
														"ScriptAppear": {
															"!Type": "ScriptDataInline",
															"Script": "-- did Oliver warn the player about Randall?\r\nreturn Storage.GetFlag(\"MQ02_OLIVER_R_SPILL_WOLF\")"
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_HelloAccuse",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Log(\"MQ02_AM_HELLO_REALLY_NOT_NICE\")\r\nStorage.ModifyNumber(\"rep_randall\", 1)"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_HelloPush",
																		"Title": "Push",
																		"Tooltip": "Give him a good shove. Back off, punk.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_HelloPush",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_HELLO_SHOVE\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02A_C_Business"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_HelloLick",
																		"Title": "Lick",
																		"Tooltip": "Lick his muzzle. Probably not what he expects.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_HelloLick",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_HELLO_LICK\")"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02A_C_Business"
																					},
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02A_C_Bellyrub",
																						"Title": "Bellyrub",
																						"Tooltip": "Tease him further with a rub on that fuzzy gut.",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02A_R_Bellyrub",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"MQ02_AM_BELLYRUB\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Choice",
																										"Key": "MQ02A_C_WillingVore",
																										"Title": "Submit",
																										"Tooltip": "Let the wolf swallow you, like the tasty preything you are.",
																										"Highlight": false,
																										"ButtonWidth": 1.0,
																										"ScriptAction": {
																											"!Type": "ScriptDataInline",
																											"Script": "-- Player gets gulped by Randall\r\nLog(\"MQ02_RANDALL_VORE_WIN_POV\")\r\nlocal fight = Combat2()\r\nfight:AddParticipant(Player)\r\nfight:AddParticipant(randall)\r\nfight:SetVored(randall, Player)\r\nfight:Begin()"
																										},
																										"Children": [
																											{
																												"NodeType": "State",
																												"Key": "MQ02A_R_Dummy1",
																												"ScriptAction": {
																													"!Type": "ScriptDataInline",
																													"Script": "-- you're not supposed to be able to win the willing vore fight\r\nerror()"
																												},
																												"Children": []
																											}
																										]
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_C_HelloPunch",
																		"Title": "Punch",
																		"Tooltip": "Your knuckles are itching. Use them.",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_R_HelloPunch",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "Log(\"MQ02_AM_HELLO_PUNCH\")\r\nStorage.ModifyNumber(\"rep_randall\", -2)"
																				},
																				"Children": [
																					{
																						"NodeType": "Link",
																						"LinkTarget": "MQ02A_BeginFight"
																					}
																				]
																			}
																		]
																	},
																	{
																		"NodeType": "Link",
																		"LinkTarget": "MQ02A_C_Stab"
																	}
																]
															}
														]
													},
													{
														"NodeType": "Choice",
														"Key": "MQ02A_C_Stab",
														"Title": "Stab",
														"Tooltip": "Quickly try to stab him with your light weapon.",
														"Highlight": true,
														"ButtonWidth": 1.0,
														"ScriptAppear": {
															"!Type": "ScriptDataVisualCondition",
															"Mode": "All",
															"Operand": true,
															"Tests": [
																{
																	"!Type": "ConditionPlayerEquipment",
																	"ItemGuid": "795c79f2-ce54-4c2f-837e-d767e3c2599a"
																}
															]
														},
														"Children": [
															{
																"NodeType": "State",
																"Key": "MQ02A_R_Stab",
																"ScriptAction": {
																	"!Type": "ScriptDataInline",
																	"Script": "Text.SetVariable(\"weapon\", Player.EquippedWeapon.Alias)\r\nLog(\"MQ02_AM_HELLO_STAB\")\r\n\r\n-- He'll remember that\r\nStorage.SetFlag(\"MQ02_RANDALL_STABBED\", true)\r\nStorage.ModifyNumber(\"rep_randall\", -3)\r\n\r\n-- Reflect the stab in the upcoming fight\r\nrandall.Health = randall.Health * 0.5"
																},
																"Children": [
																	{
																		"NodeType": "Choice",
																		"Key": "MQ02A_BeginFight",
																		"Title": "Let's roll",
																		"Highlight": false,
																		"ButtonWidth": 1.0,
																		"ScriptAction": {
																			"!Type": "ScriptDataInline",
																			"Script": "-- Player fights Randall and two goons\r\nStorage.SetFlag(\"MQ02_RANDALL_FOUGHT\", true)\r\nlocal fight = Combat2()\r\nfight:AddParticipant(Player)\r\nfight:AddParticipant(randall)\r\nfight:AddParticipant(goon1)\r\nfight:AddParticipant(goon2)\r\nfight:OnCreatureVored(function(predator, prey)\r\n    if predator == Player then\r\n        -- Dialogue changes if any goon got gulped\r\n        Storage.SetFlag(\"MQ02_RANDALL_GOON_EATEN\", true)\r\n\r\n        -- The tigress in particular, comes up in MQ03\r\n        if prey == goon2 then\r\n            Storage.SetFlag(\"MQ02_RANDALL_TIGRESS_EATEN\", true)\r\n        end\r\n    end\r\nend)\r\nfight:Begin()"
																		},
																		"Children": [
																			{
																				"NodeType": "State",
																				"Key": "MQ02A_WinFight",
																				"ScriptAction": {
																					"!Type": "ScriptDataInline",
																					"Script": "if Storage.GetFlag(\"MQ02_RANDALL_GOON_EATEN\") then\r\n    -- Alternate text if either of the goons are eaten\r\n    Log(\"MQ02_AM_WINFIGHT_NOBACKUP\")\r\nelse\r\n    Log(\"MQ02_AM_WINFIGHT\")\r\nend"
																				},
																				"Children": [
																					{
																						"NodeType": "Choice",
																						"Key": "MQ02A_C_WinChase",
																						"Title": "Continue",
																						"Highlight": false,
																						"ButtonWidth": 1.0,
																						"Children": [
																							{
																								"NodeType": "State",
																								"Key": "MQ02A_R_WinChase",
																								"ScriptAction": {
																									"!Type": "ScriptDataInline",
																									"Script": "Log(\"MQ02_AM_WINFIGHT_LETGO\")"
																								},
																								"Children": [
																									{
																										"NodeType": "Link",
																										"LinkTarget": "MQ02A_C_Finish"
																									}
																								]
																							}
																						]
																					}
																				]
																			}
																		]
																	}
																]
															}
														]
													}
												]
											}
										]
									}
								]
							}
						]
					}
				]
			},
			{
				"NodeType": "State",
				"Key": "ENC_None",
				"ScriptAction": {
					"!Type": "ScriptDataInline",
					"Script": "Log(\"ROAD_NO_ENC\")"
				},
				"Children": [
					{
						"NodeType": "Choice",
						"Key": "GoNextEncounter",
						"Title": "Move on",
						"Highlight": false,
						"ButtonWidth": 1.0,
						"ScriptAction": {
							"!Type": "ScriptDataInline",
							"Script": "ContinueRoadTravel()"
						},
						"Children": []
					}
				]
			}
		]
	}
}